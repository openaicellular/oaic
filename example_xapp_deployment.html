

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KPIMON xApp Deployment &mdash; OAIC 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="xApp Deployment - General Guidelines" href="xapp_deployment.html" />
    <link rel="prev" title="O-RAN Non-Real Time RIC Installation Guide" href="nonrtric.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            OAIC
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="oaic_features.html">OAIC Features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Background Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="background_cloud.html">Background on Docker, Kubernetes &amp; Helm</a></li>
<li class="toctree-l1"><a class="reference internal" href="background_oran_architecture.html">O-RAN Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="background_srsRAN.html">RAN Architecture</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation Procedures:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Hardware and Software Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="oran_installation.html">O-RAN Near-Real Time RIC Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="srsRAN_installation.html">srsRAN with E2 Agent Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup5gnetwork.html">Setup your own 5G Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="MultipleUEs.html">Multiples UEs ZMQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonrtric.html">O-RAN Non-Real Time RIC Installation Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">xApp Deployment:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">KPIMON xApp Deployment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#hosting-the-config-files">Hosting the config Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-kpimon-xapp-docker-image">Creating KPIMON xApp Docker image</a></li>
<li class="toctree-l2"><a class="reference internal" href="#xapp-onboarder-deployment">xApp Onboarder Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#get-variables">Get Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#check-for-helm-charts">Check for helm charts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-a-url-file">Create a .url file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deploying-the-xapp">Deploying the xApp</a></li>
<li class="toctree-l3"><a class="reference internal" href="#verifying-xapp-deployment">Verifying xApp Deployment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xapp-re-deployment-undeployment">xApp Re-Deployment &amp; Undeployment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="xapp_deployment.html">xApp Deployment - General Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="nexran1.html">Running the Nexran Xapp</a></li>
<li class="toctree-l1"><a class="reference internal" href="ssxapp.html">Running the SS Xapp</a></li>
<li class="toctree-l1"><a class="reference internal" href="idxapp.html">Deploying the Intrusion Detection xApp</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="undeploy_ric.html">UnDeploying RIC Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="srsRAN_additional_features.html">srsRAN Additional Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="kubectl_commands.html">Kubectl Commands - Cheat Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="oaic_t.html">OAIC-T</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">2024 OAIC Workshop</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="2024_workshop_gcp.html">Day 1 - Google Cloud Platform Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="2024_workshop_ss.html">Day 1 - Secure Slicing xApp</a></li>
<li class="toctree-l1"><a class="reference internal" href="xapp_python.html">Day 2 - Developing a custom xApp in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="edgeric-workshop-tutorial.html">Day 2 - EdgeRIC tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="OAIC-2024-Workshop-oai-flexric-documentation.html">Day 2 - OAI/FlexRIC Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="OAIC-T-fast-setup.html">Day 3 - OAIC-T</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">OAIC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">KPIMON xApp Deployment</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/example_xapp_deployment.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="kpimon-xapp-deployment">
<span id="kpimon-deployment"></span><h1>KPIMON xApp Deployment<a class="headerlink" href="#kpimon-xapp-deployment" title="Link to this heading"></a></h1>
<p>Here we are going to deploy KPIMON xApp as an example of xApp deployment. Please follow the steps to see the results.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The near-RT RIC installation has to be completed before proceeding with the following sections.</p>
</div>
<section id="hosting-the-config-files">
<h2>Hosting the config Files<a class="headerlink" href="#hosting-the-config-files" title="Link to this heading"></a></h2>
<p>As indicated in the <a class="reference internal" href="xapp_deployment.html#xappdeployment"><span class="std std-ref">Genral guidelines to Deploy an xApp</span></a> section , we first need to host the config file (xApp descriptor) provided in the web server we have created already. Follow the instructions to <a class="reference internal" href="xapp_deployment.html#createnginx"><span class="std std-ref">create a Web server</span></a> and continue with next steps</p>
<p>Create a symlink from the xapp’s config file (in this case kpimon).This can be replaced by another symlink in the future. Reload Nginx once this has been done.</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>sudo cp ric-scp-kpimon/scp-kpimon-config-file.json /var/www/xApp_config.local/config_files/
sudo systemctl reload nginx
</pre></div>
</div>
<p>Now, you can check if the config file can be accessed from the newly created server. Place all files you want to host in the <code class="docutils literal notranslate"><span class="pre">config_files</span></code> directory</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>export MACHINE_IP=<span class="nv">`hostname  -I | cut -f1 -d&#39; &#39;`</span>
curl http://${MACHINE_IP}:5010/config_files/scp-kpimon-config-file.json
</pre></div>
</div>
<p>We host the config file on the web server to make it possible for the onboarder to download and use it for deployment.</p>
</section>
<section id="creating-kpimon-xapp-docker-image">
<h2>Creating KPIMON xApp Docker image<a class="headerlink" href="#creating-kpimon-xapp-docker-image" title="Link to this heading"></a></h2>
<p>Now, we create a docker image of the KPIMON xApp using the given docker file.</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>cd ric-scp-kpimon
sudo docker build . -t xApp-registry.local:5008/scp-kpimon:1.0.1
</pre></div>
</div>
</section>
<section id="xapp-onboarder-deployment">
<h2>xApp Onboarder Deployment<a class="headerlink" href="#xapp-onboarder-deployment" title="Link to this heading"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Before Deploying the xApp, it is essential to have the <a class="reference internal" href="xapp_deployment.html#xappdeployment"><span class="std std-ref">5G Network Up and Running</span></a>. Otherwise the subscription procedure will not be successful.</p>
</div>
<section id="get-variables">
<h3>Get Variables<a class="headerlink" href="#get-variables" title="Link to this heading"></a></h3>
<p>First, we need to get some variables of RIC Platform ready. The following variables represent the IP addresses of the services running on the RIC Platform.</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>export KONG_PROXY=<span class="nv">`sudo kubectl get svc -n ricplt -l app.kubernetes.io/name=kong -o jsonpath=&#39;{.items[0].spec.clusterIP}&#39;`</span>
export APPMGR_HTTP=<span class="nv">`sudo kubectl get svc -n ricplt --field-selector metadata.name=service-ricplt-appmgr-http -o jsonpath=&#39;{.items[0].spec.clusterIP}&#39;`</span>
export ONBOARDER_HTTP=<span class="nv">`sudo kubectl get svc -n ricplt --field-selector metadata.name=service-ricplt-xapp-onboarder-http -o jsonpath=&#39;{.items[0].spec.clusterIP}&#39;`</span>
</pre></div>
</div>
</section>
<section id="check-for-helm-charts">
<h3>Check for helm charts<a class="headerlink" href="#check-for-helm-charts" title="Link to this heading"></a></h3>
<p>Get helm charts and check if the current xApp is one of them. If there is no helm chart, then we are good to go. Otherwise, we have to use the existing chart or delete it and then proceed forward.</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>curl --location --request GET &quot;http://$KONG_PROXY:32080/onboard/api/v1/charts&quot;
</pre></div>
</div>
</section>
<section id="create-a-url-file">
<h3>Create a .url file<a class="headerlink" href="#create-a-url-file" title="Link to this heading"></a></h3>
<p>Next, we need to create a <code class="docutils literal notranslate"><span class="pre">.url</span></code> file to point the <code class="docutils literal notranslate"><span class="pre">xApp-onboarder</span></code> to the Ngnix server to get the xApp descriptor file and use it to create a helm chart and deploy the xApp.</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>vim scp-kpimon-onboard.url
</pre></div>
</div>
<p>Paste the following in the <code class="docutils literal notranslate"><span class="pre">onboard.url</span></code> file. Substitue the <code class="docutils literal notranslate"><span class="pre">&lt;machine_ip_addr&gt;</span></code> with the IP address of your machine. You can find this out through <code class="docutils literal notranslate"><span class="pre">ifconfig</span></code>.</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>{&quot;config-file.json_url&quot;:&quot;http://&lt;machine_ip_addr&gt;:5010/config_files/scp-kpimon-config-file.json&quot;}
</pre></div>
</div>
<p>Save the file. Now we are ready to deploy the xApp.</p>
</section>
<section id="deploying-the-xapp">
<h3>Deploying the xApp<a class="headerlink" href="#deploying-the-xapp" title="Link to this heading"></a></h3>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>curl -L -X POST &quot;http://$KONG_PROXY:32080/onboard/api/v1/onboard/download&quot; --header &#39;Content-Type: application/json&#39; --data-binary &quot;@scp-kpimon-onboard.url&quot;
curl -L -X GET &quot;http://$KONG_PROXY:32080/onboard/api/v1/charts&quot;
curl -L -X POST &quot;http://$KONG_PROXY:32080/appmgr/ric/v1/xapps&quot; --header &#39;Content-Type: application/json&#39; --data-raw &#39;{&quot;xappName&quot;: &quot;scp-kpimon&quot;}&#39;
</pre></div>
</div>
</section>
<section id="verifying-xapp-deployment">
<h3>Verifying xApp Deployment<a class="headerlink" href="#verifying-xapp-deployment" title="Link to this heading"></a></h3>
<p>There should be a <code class="docutils literal notranslate"><span class="pre">ricxapp-scp-kpimon</span></code> pod in <code class="docutils literal notranslate"><span class="pre">ricxapp</span></code> namespace</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>sudo kubectl get pods -A
</pre></div>
</div>
<p>We can check the xApp logs using</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>sudo kubectl logs -f -n ricxapp -l app=ricxapp-scp-kpimon
</pre></div>
</div>
<p>Since the E2 Node is already up and running and the Key Performance Metrics (KPM) RAN function is enabled by default, the xApp will be able to subscribe to the E2 Node and start getting <strong>INDICATION</strong> messages. The decoded message containing information about the metrics is stored in the <code class="docutils literal notranslate"><span class="pre">kpimon.log</span></code> within the pod. This can be viewed by,</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>sudo kubectl exec -it -n ricxapp <span class="nv">`sudo kubectl get pod -n ricxapp -l app=ricxapp-scp-kpimon -o jsonpath=&#39;{.items[0].metadata.name}&#39;`</span> -- tail -F /opt/kpimon.log
</pre></div>
</div>
</section>
</section>
<section id="xapp-re-deployment-undeployment">
<h2>xApp Re-Deployment &amp; Undeployment<a class="headerlink" href="#xapp-re-deployment-undeployment" title="Link to this heading"></a></h2>
<p>To redeploy the xApp, on the near-RT RIC side, run the command</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>sudo kubectl -n ricxapp rollout restart deployment ricxapp-scp-kpimon
</pre></div>
</div>
<p>To Undeploy the xApp, first let’s get the IP address of the <code class="docutils literal notranslate"><span class="pre">App</span> <span class="pre">Manager</span></code></p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>export APPMGR_HTTP=<span class="nv">`sudo kubectl get svc -n ricplt --field-selector metadata.name=service-ricplt-appmgr-http -o jsonpath=&#39;{.items[0].spec.clusterIP}&#39;`</span>
curl -L -X DELETE http://${APPMGR_HTTP}:8080/ric/v1/xapps/scp-kpimon
</pre></div>
</div>
<p>To remove the xApp descriptors from the Chart Museum, use the command</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>curl -L -X DELETE &quot;http://${ONBOARDER_HTTP}:8080/api/charts/scp-kpimon/1.0.1&quot;
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="nonrtric.html" class="btn btn-neutral float-left" title="O-RAN Non-Real Time RIC Installation Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="xapp_deployment.html" class="btn btn-neutral float-right" title="xApp Deployment - General Guidelines" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, OAIC.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>